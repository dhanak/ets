#!/bin/bash
#
# Usage:
#
# ./guts-docker shell - to run a shell in the container
# ./guts-docker <cmd> <args> - to directly run a guts command in the container

# check for running container
id=$(docker compose ps -q guts)
if [[ -n $id ]]; then
    cmd='exec'
    extra=('' '-T')
else
    cmd='run --rm'
    extra=('-it' '')
fi

# invoke shell or guts command directly
if [[ $* == shell ]]; then
    exec docker compose $cmd ${extra[0]} guts /bin/bash
else
    exec docker compose $cmd ${extra[1]} guts ./guts "$@"
fi
