<%doc> This is a -*- mason -*- template.
Handler of the Prolog Success/Failure/Error (PSFE) scheme.
</%doc>
<%attr>submit => "included"</%attr>
<%method longname>Prolog siker/meghiúsulás/hiba</%method>

<%args> $exdata </%args>

Döntsd el az alábbi Prolog célról, hogy hogyan fut le!
% if ($exdata->{QUERY} =~ /X/) {
Sikeres futás esetén add meg az <code>X</code> változó értékét!
% }

<P>(Mindegyik célt a Prolog interpreternek önmagában adjuk oda, azaz
futásának kezdetén a célban előforduló változóknak nincs értéke.
Feltételezzük, hogy a <code>lists</code> könyvtár be van töltve.)

<PRE>| ?- <% $exdata->{QUERY} %>.</PRE>

<%method helpref>
<%args>
$category
</%args>
<%init>;
if ($category eq 'PEG0' || $category eq 'PARI') {
    return "hints?topic=PSFE/$category";
}
return undef;
</%init>
</%method>

<%method answers>
<%args>
$exdata
$answer => ""
</%args>
<INPUT TYPE=submit name=succ value="Siker">
% if ($exdata->{QUERY} =~ /X/) {
<CODE>X = </CODE><INPUT TYPE=text NAME=answer SIZE=60 VALUE="<% $answer %>"><BR>
% } else {
<INPUT TYPE=hidden NAME=answer>
% }
% if ($exdata->{OPTIONS} !~ '-fail') {
<INPUT TYPE=submit name=fail value="Meghiúsulás">
% }
% if ($exdata->{OPTIONS} !~ '-synerr') {
<INPUT TYPE=submit name=synerr value="Szintaktikai hiba">
% }
% if ($exdata->{OPTIONS} !~ '-runerr') {
<INPUT TYPE=submit name=runerr value="Futási hiba">
% }
</%method>

<%method check>
<%args>
$exdata
$answer
$succ    => undef
$fail    => undef
$synerr  => undef
$runerr  => undef
</%args>

<%init>
my ($msg, $ret, $what);

$what = "SUCC"   if $succ;
$what = "FAIL"   if $fail;
$what = "SYNERR" if $synerr;
$what = "RUNERR" if $runerr;

if (!defined $what) {
    return "Add meg <code>X</code> értékét és válassz a gombok közül!"
	if $answer =~ /^\s*$/;
    $what = "SUCC";
}

($ret, $msg) = $m->comp('/sub/prolog_script', script => "psfe_check",
			args => [$what, $answer, $exdata->{QUERY}]);

return ($ret == 1) ? undef : $msg;
</%init>
</%method>

<%method errstr>
<%args>
$exdata
$error
</%args>
<% $error %>
</%method>

<%method describe>
<%args>
$exdata
</%args>
<% $exdata->{QUERY} %>
</%method>

<%method params>
<%args>
$exdata
</%args>
<TABLE>
<TR><TD>A hívás:
<TD><INPUT TYPE=text NAME=query SIZE=60 VALUE="<% $exdata->{QUERY} %>">
<TR><TD>Opciók:
<TD><INPUT TYPE=checkbox NAME=options VALUE="-fail"
           <% $exdata->{OPTIONS} =~ "-fail" ? "checked" : "" %>>
	   nincs meghiúsulás
<TR><TD><TD><INPUT TYPE=checkbox NAME=options VALUE="-synerr"
           <% $exdata->{OPTIONS} =~ "-synerr" ? "checked" : "" %>>
	   nincs szintaktikai hiba
<TR><TD><TD><INPUT TYPE=checkbox NAME=options VALUE="-runerr"
           <% $exdata->{OPTIONS} =~ "-runerr" ? "checked" : "" %>>
	   nincs futási hiba
</TABLE>
</%method>

<%method calcdata>
<%args>
$query
@options => ()
</%args>
<%init>;
return { QUERY => $query, OPTIONS => join ",", @options };
</%init>
</%method>
